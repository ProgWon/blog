---
title: "ì—ëŸ¬ 0%, MSAì—ì„œì˜ Enum ê´€ë¦¬ ì „ëµ"
date: "2024-12-18"
description: "í† ìŠ¤ë±…í¬ ì—¬ì‹ ì˜ ë°œì „í•˜ëŠ” MSAì—ì„œ Enumì„ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•˜ëŠ” ë…¸í•˜ìš°ë¥¼ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤."
tags: ["ê°œë°œ", "MSA", "ë°±ì—”ë“œ"]
author: "ê¹€ì¸íšŒ/ì´ì¤€ì˜ Â· í† ìŠ¤ë±…í¬ ë°±ì—”ë“œ ê°œë°œì"
---

ì•ˆë…•í•˜ì„¸ìš”, í† ìŠ¤ë±…í¬ ì—¬ì‹ íŒ€ì˜ ê¹€ì¸íšŒ, ì´ì¤€ì˜ì…ë‹ˆë‹¤.

ì˜¤ëŠ˜ì€ MSA(Microservices Architecture) í™˜ê²½ì—ì„œ Enumì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤. í† ìŠ¤ë±…í¬ ì—¬ì‹ íŒ€ì—ì„œ ì‹¤ì œë¡œ ì ìš©í•˜ê³  ìˆëŠ” ì „ëµê³¼ ë…¸í•˜ìš°ë¥¼ ê³µìœ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## ë¬¸ì œ ìƒí™©

MSA í™˜ê²½ì—ì„œ ì„œë¹„ìŠ¤ ê°„ í†µì‹ ì„ í•  ë•Œ, Enum íƒ€ì…ì˜ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê° ì„œë¹„ìŠ¤ê°€ ë…ë¦½ì ìœ¼ë¡œ ë°°í¬ë˜ë‹¤ ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œë“¤ì´ ë°œìƒí•  ìˆ˜ ìˆì–´ìš”:

### 1. ë²„ì „ ë¶ˆì¼ì¹˜ ë¬¸ì œ

```java
// ì„œë¹„ìŠ¤ A (v1.0)
public enum LoanStatus {
    PENDING,
    APPROVED,
    REJECTED
}

// ì„œë¹„ìŠ¤ B (v1.1) - ìƒˆë¡œìš´ ìƒíƒœ ì¶”ê°€
public enum LoanStatus {
    PENDING,
    APPROVED,
    REJECTED,
    CANCELLED  // ìƒˆë¡œ ì¶”ê°€ëœ ìƒíƒœ
}
```

### 2. ì—­í˜¸í™˜ì„± ë¬¸ì œ

ì„œë¹„ìŠ¤ Aê°€ `CANCELLED` ìƒíƒœë¥¼ ëª¨ë¥´ëŠ” ìƒí™©ì—ì„œ ì„œë¹„ìŠ¤ Bë¡œë¶€í„° í•´ë‹¹ ê°’ì„ ë°›ìœ¼ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?

> ì´ëŸ° ìƒí™©ì—ì„œëŠ” ëŒ€ë¶€ë¶„ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê±°ë‚˜, ë°ì´í„°ê°€ ì†ì‹¤ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## í•´ê²° ì „ëµ

### 1. Unknown íŒ¨í„´ ì ìš©

```java
public enum LoanStatus {
    PENDING,
    APPROVED,
    REJECTED,
    CANCELLED,
    UNKNOWN;  // ì•Œ ìˆ˜ ì—†ëŠ” ìƒíƒœë¥¼ ìœ„í•œ fallback

    public static LoanStatus fromString(String value) {
        try {
            return LoanStatus.valueOf(value.toUpperCase());
        } catch (IllegalArgumentException e) {
            return UNKNOWN;  // ì•Œ ìˆ˜ ì—†ëŠ” ê°’ì€ UNKNOWNìœ¼ë¡œ ì²˜ë¦¬
        }
    }
}
```

### 2. ë²„ì „ ê´€ë¦¬ ì „ëµ

Enumì˜ ë³€ê²½ì‚¬í•­ì„ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ê·œì¹™ì„ ì ìš©í•©ë‹ˆë‹¤:

- **ì¶”ê°€ë§Œ í—ˆìš©**: ê¸°ì¡´ ê°’ì€ ì ˆëŒ€ ì‚­ì œí•˜ì§€ ì•Šê³ , ìƒˆë¡œìš´ ê°’ë§Œ ì¶”ê°€
- **ìˆœì„œ ë³´ì¥**: Enumì˜ ìˆœì„œë¥¼ ë³€ê²½í•˜ì§€ ì•ŠìŒ
- **ë„¤ì´ë° ì¼ê´€ì„±**: ëª…ëª… ê·œì¹™ì„ ì—„ê²©í•˜ê²Œ ìœ ì§€

### 3. ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©

```java
// common-enums ë¼ì´ë¸ŒëŸ¬ë¦¬
@JsonDeserialize(using = SafeEnumDeserializer.class)
public enum LoanStatus implements SafeEnum {
    PENDING("ëŒ€ê¸°ì¤‘"),
    APPROVED("ìŠ¹ì¸"),
    REJECTED("ê±°ì ˆ"),
    CANCELLED("ì·¨ì†Œ"),
    UNKNOWN("ì•Œìˆ˜ì—†ìŒ");

    private final String description;

    LoanStatus(String description) {
        this.description = description;
    }

    @Override
    public boolean isUnknown() {
        return this == UNKNOWN;
    }
}
```

## ì‹¤ì œ ì ìš© ì‚¬ë¡€

í† ìŠ¤ë±…í¬ ì—¬ì‹ íŒ€ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ Enumì„ ê´€ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤:

### 1. API ì‘ë‹µ ì²˜ë¦¬

```java
@RestController
public class LoanController {

    @GetMapping("/loans/{id}")
    public LoanResponse getLoan(@PathVariable Long id) {
        Loan loan = loanService.findById(id);

        // Unknown ìƒíƒœ ì²´í¬ ë° ë¡œê¹…
        if (loan.getStatus().isUnknown()) {
            log.warn("Unknown loan status detected: {}", loan.getStatus());
            // ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì— ì•Œë¦¼
            monitoringService.alert("UNKNOWN_ENUM_DETECTED", loan.getId());
        }

        return LoanResponse.from(loan);
    }
}
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥

```java
@Entity
public class Loan {

    @Enumerated(EnumType.STRING)  // ORDINAL ëŒ€ì‹  STRING ì‚¬ìš©
    @Column(name = "status")
    private LoanStatus status;

    // Unknown ìƒíƒœ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì„œë“œ
    public void updateStatus(LoanStatus newStatus) {
        if (newStatus.isUnknown()) {
            log.error("Attempting to set unknown status: {}", newStatus);
            throw new IllegalArgumentException("Cannot set unknown status");
        }
        this.status = newStatus;
    }
}
```

<Ad />

## ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼

Unknown ìƒíƒœê°€ ê°ì§€ë˜ë©´ ì¦‰ì‹œ ê°œë°œíŒ€ì— ì•Œë¦¼ì´ ê°€ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤:

```java
@Component
public class EnumMonitoringService {

    private final SlackNotifier slackNotifier;
    private final MetricRegistry metricRegistry;

    public void reportUnknownEnum(String enumType, String unknownValue) {
        // ë©”íŠ¸ë¦­ ìˆ˜ì§‘
        metricRegistry.counter("unknown.enum.detected",
                              "type", enumType,
                              "value", unknownValue)
                     .increment();

        // Slack ì•Œë¦¼
        slackNotifier.sendAlert(
            String.format("ğŸš¨ Unknown enum detected: %s = %s", enumType, unknownValue)
        );
    }
}
```

## í…ŒìŠ¤íŠ¸ ì „ëµ

Enum ë³€ê²½ì— ëŒ€í•œ ì•ˆì „ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤:

```java
@Test
public void testEnumBackwardCompatibility() {
    // ê¸°ì¡´ ê°’ë“¤ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
    assertThat(LoanStatus.valueOf("PENDING")).isEqualTo(LoanStatus.PENDING);
    assertThat(LoanStatus.valueOf("APPROVED")).isEqualTo(LoanStatus.APPROVED);
    assertThat(LoanStatus.valueOf("REJECTED")).isEqualTo(LoanStatus.REJECTED);
}

@Test
public void testUnknownEnumHandling() {
    // ì•Œ ìˆ˜ ì—†ëŠ” ê°’ì— ëŒ€í•œ ì²˜ë¦¬ í™•ì¸
    LoanStatus unknown = LoanStatus.fromString("INVALID_STATUS");
    assertThat(unknown).isEqualTo(LoanStatus.UNKNOWN);
    assertThat(unknown.isUnknown()).isTrue();
}
```

## ê²°ê³¼

ì´ëŸ¬í•œ ì „ëµì„ ì ìš©í•œ ê²°ê³¼:

- **ì—ëŸ¬ìœ¨ 0%**: Enum ê´€ë ¨ ëŸ°íƒ€ì„ ì—ëŸ¬ ì™„ì „ ì œê±°
- **ì•ˆì „í•œ ë°°í¬**: ì„œë¹„ìŠ¤ ê°„ ë²„ì „ ì°¨ì´ë¡œ ì¸í•œ ì¥ì•  ë°©ì§€
- **ë¹ ë¥¸ ëŒ€ì‘**: Unknown ìƒíƒœ ê°ì§€ ì‹œ ì¦‰ì‹œ ì•Œë¦¼ìœ¼ë¡œ ë¹ ë¥¸ ëŒ€ì‘ ê°€ëŠ¥

## ë§ˆì¹˜ë©°

MSA í™˜ê²½ì—ì„œ Enumì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” ê²ƒì€ ìƒê°ë³´ë‹¤ ë³µì¡í•œ ë¬¸ì œì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì²´ê³„ì ì¸ ì „ëµê³¼ ëª¨ë‹ˆí„°ë§ì„ í†µí•´ ì•ˆì •ì ì¸ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ìˆ˜ ìˆì–´ìš”.

ì—¬ëŸ¬ë¶„ì˜ íŒ€ì—ì„œë„ ë¹„ìŠ·í•œ ë¬¸ì œë¥¼ ê²ªê³  ê³„ì‹œë‹¤ë©´, ì˜¤ëŠ˜ ì†Œê°œí•œ ë°©ë²•ë“¤ì„ ì°¸ê³ í•´ì„œ ì ìš©í•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤. ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ëŒ“ê¸€ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”!
